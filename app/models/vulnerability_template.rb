class VulnerabilityTemplate < ActiveRecord::Base

  validates :uri, uniqueness: true, presence: true

  validate :uri_must_be_well_formed

  VALID_SCHEMES = %w| http https file|



  private

  def uri_must_be_well_formed
    begin
      uri_object = URI.parse(uri)
    rescue URI::InvalidURIError
      errors.add(:uri, 'Invalid Location')
    end
    errors.add(:uri, 'Unsupported scheme') unless VALID_SCHEMES.include?(uri_object.scheme)


  end
end
